// server/api/file.ts

import { defineEventHandler } from 'h3'
import fs from 'fs'
import path from 'path'

export default defineEventHandler(async (event) => {
  const fileName = event.context.params.fileName
  const filePath = path.resolve('logs', fileName)

  try {
    const fileContents = fs.readFileSync(filePath, 'utf-8')
    const jsonData = JSON.parse(fileContents)
    return jsonData
  } catch (error) {
    // Handle error (file not found, invalid JSON, etc.)
    event.res.statusCode = 404
    return { error: 'File not found or invalid JSON' }
  }
})
